YUI.add("datatable-edit",function(e){var t="activeCell",n="activeRowIndex",r="activeColIndex",i=e.Array,s=e.Object,o;e.DataTableEditExt=o=function(){},o.ATTRS={inlineEditors:{}},o.prototype={initializer:function(){var t=this;e.Do.after(t._renderInlineEditors,t,"renderUI"),e.Do.after(t._hookSyncUIAfterBodyRender,t,"syncUI"),t.keyBindings.plain=e.merge(t.keyBindings.plain,{45:t.addAfterCurrentRow,46:t.deleteCurrentRow,13:t.doEdit}),t.keyBindings.shift=e.merge(t.keyBindings.shift,{45:t.addBeforeCurrentRow})},_hookSyncUIAfterBodyRender:function(){var t=this;e.Do.after(t._afterSyncUINavigate,t.body,"render",t)},_renderInlineEditors:function(){var e=this,t=e.get("inlineEditors"),n=e.get("boundingBox");s.each(t,function(e,t,r){e.set("constrainNode",n),e.render()})},_bindUIEdit:function(t){var n=this,r=[];r.push(t.after("cancel",e.bind(n._cancelEdit,n))),r.push(t.after("done",e.bind(n._doneEdit,n))),n._editorEventHandles=r},_unbindUIEdit:function(){var e=this.editorEventHandles;e&&i.each(e,function(e){e.detach()})},_cancelEdit:function(e){var t=this;t._unbindUIEdit(),t.focus()},_doneEdit:function(e){var t=this,i=t.get("data"),s=t.get("columns"),o=t.get(n),u=t.get(r),a=i.item(o),f=s[u].key,l=s[u],c=l.editFunction,h={src:"UI"};t._unbindUIEdit(),c&&c(e,a,h),a.set(f,e.value,h),t.focus()},doEdit:function(){var e=this,i=e.get(t),s=e.get("data"),o=e.get("columns"),u=e.get(n),a=e.get(r),f=s.item(u),l=o[a],c=o[a].key,h=e.get("inlineEditors"),p,d;d=h[l.inlineEditor];if(!d)return;o[a].editFromNode?p=i.get("text"):p=f.get(c),e._bindUIEdit(d),d.show(i,p)},addAfterCurrentRow:function(){var e=this,t=e.get("data"),r=e.get(n)+1,i=e.get("recordType");t.add(new i,{index:r}),e.set(n,r)},addBeforeCurrentRow:function(){var e=this,t=e.get("data"),r=e.get(n),i=e.get("recordType");t.add(new i,{index:r}),e.set(n,r)},deleteCurrentRow:function(){var e=this,t=e.get("data"),r,i;if(t.size()===0)return;r=e.get(n),i=t.item(r),t.remove(i),t.size()===r&&e.set(n,r-1)}},e.DataTableEdit=e.Base.mix(e.DataTableNavigate,[o])});
