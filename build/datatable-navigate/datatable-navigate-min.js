YUI.add("datatable-navigate",function(e){var t="activeRowIndex",n="activeColIndex",r="activeCell",i="activeRow",s="Change",o="UP",u="DOWN",a="LEFT",f="RIGHT",l="NONE",c,h,p;e.DataTableNavigate=e.Base.create("datatable",e.DataTable,[e.DataTable.EventBindings],{initializer:function(){var o=this;o.after(t+s,o._afterActiveRowIndexChange),o.after(n+s,o._afterActiveColIndexChange),o.after(r+s,o._afterActiveCellChange),o.after(i+s,o._afterActiveRowChange),e.Do.after(o._afterRenderUINavigate,o,"renderUI"),e.Do.after(o._afterFocusNavigate,o,"focus"),e.Do.after(o._afterSyncUINavigate,o,"syncUI"),h=o.getClassName("navigate","activeCell"),c=o.getClassName("navigate","activeRow"),p=o.getClassName("navigate","clipboard"),o.keyBindings=e.merge(o.keyBindings,{plain:{35:o.moveToLastColumn,36:o.moveToFirstColumn,37:o.moveLeft,38:o.moveUp,39:o.moveRight,40:o.moveDown},ctrl:{35:o.moveToLastCell,36:o.moveToFirstCell}})},_activeRowIndexValidator:function(e){var t=e,n;return t<0?!1:(n=this.get("data").size(),t>=n?!1:!0)},_activeColIndexValidator:function(e){var t=e,n;return t<0?!1:(n=this.get("columns").length,t>=n?!1:!0)},_afterRenderUINavigate:function(){var t=this,n=t.get("contentBox");t._clipTextArea=e.Node.create(e.substitute('<textarea class="{className}"></textarea>',{className:p})),n.prepend(this._clipTextArea)},_afterFocusNavigate:function(){var t=this,n=t.get(i);e.later(0,t._clipTextArea,t._clipTextArea.focus),n&&t._scrollRowIntoView(n)},_afterSyncUINavigate:function(){var e=this,s=e.get(t),o=e.get(n),u=e.getRow(s),a=e.getCell([s,o]);e.set(i,u),e.set(r,a)},_afterActiveRowIndexChange:function(e){var t=this,s=t.getRow(e.newVal),o=t.getCell([e.newVal,t.get(n)]);t.set(i,s),t.set(r,o)},_afterActiveColIndexChange:function(e){var n=this,i=n.getCell([n.get(t),e.newVal]);n.set(r,i)},_afterActiveCellChange:function(e){this._uiSetActiveCell(e.prevVal,e.newVal)},_afterActiveRowChange:function(e){this._uiSetActiveRow(e.prevVal,e.newVal)},_uiSetActiveRow:function(e,t){e&&e.removeClass(c),t&&(t.addClass(c),this._scrollRowIntoView(t))},_scrollRowIntoView:function(e){var t=this._direction,n;if(t===l)return;e.inRegion(e.get("viewportRegion"),!0)||(t===u?n=e.next():t===o&&(n=e.previous()),n?n.scrollIntoView():e.scrollIntoView())},_uiSetActiveCell:function(e,t){e&&e.removeClass(h),t&&t.addClass(h)},moveUp:function(){var e=this,n=e.get(t);n-=1,e._direction=o,e.set(t,n)},moveDown:function(){var e=this,n=e.get(t);n+=1,e._direction=u,e.set(t,n)},moveLeft:function(){var e=this,t=e.get(n);t-=1,e._direction=a,e.set(n,t)},moveRight:function(){var e=this,t=e.get(n);t+=1,e._direction=f,e.set(n,t)},moveToFirstColumn:function(){this.set(n,0)},moveToLastColumn:function(){var e=this.get("columns").length-1;this.set(n,e)},moveToFirstCell:function(){this.set(t,0),this.set(n,0)},moveToLastCell:function(){var e=this,r=e.get("data").size()-1,i=e.get("columns").length-1;e.set(t,r),e.set(n,i)},setAsActiveCell:function(e){var s=this,o=e.get("parentNode"),u=o.getAttribute("data-yui3-record"),a=s.get("data"),f,l,c;f=a.getByClientId(u),l=a.indexOf(f),c=o.get("children").indexOf(e),s._set(t,l),s._set(n,c),s.set(i,o),s.set(r,e)},_mouseDownHandler:function(t){var n=this,r;r=t.domEvent.target.ancestor("td",!0),r&&n.setAsActiveCell(r),e.DataTable.EventBindings.prototype._mouseDownHandler.call(n,t)}},{ATTRS:{activeCell:{},activeRowIndex:{value:0,validator:"_activeRowIndexValidator"},activeColIndex:{value:0,validator:"_activeColIndexValidator"},activeRow:{value:null}}})});
